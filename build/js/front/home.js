/*! qadashboard 2018-03-18 by sillicon */

window.onload=function(){var e=function(){var e=new Date,t=e.getDate(),n=e.getMonth()+1,a=e.getFullYear();t<10&&(t="0"+t);n<10&&(n="0"+n);return a+"-"+n+"-"+t}();"date"!=$("#chooseDay")[0].type?($("#chooseDay").datepicker(),$("#chooseDay").datepicker("option","maxDate",new Date)):document.querySelector("#chooseDay").max=e,document.querySelector("#chooseDay").value=e,document.querySelector("#chooseDay").title="Click to change date",isOpera=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,isFirefox="undefined"!=typeof InstallTrigger,isSafari=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||safari.pushNotification).toString(),isIE=!!document.documentMode,isEdge=!isIE&&!!window.StyleMedia,isChrome=!!window.chrome&&!!window.chrome.webstore,isBlink=(isChrome||isOpera)&&!!window.CSS,document.querySelector("body").addEventListener("click",function(e){"path"!=e.target.tagName&&(document.querySelector("#reportList").style.display="none")});let t=document.querySelectorAll("#contentNavi a");for(let e=0;e<t.length;e++)t[e].addEventListener("click",function(e){l(e.target)});t=document.querySelectorAll("#buttonGroup2 div,#buttonGroup3 div");for(let e=0;e<t.length;e++)t[e].addEventListener("click",function(e){c(e.target)});document.querySelector("#summary").addEventListener("click",function(){!function(){let e={cate1CateNum:0,cate1CateTest:0,cate1TestNum:0,cate1TestPass:0,cate2CateNum:0,cate2CateTest:0,cate2TestNum:0,cate2TestPass:0,cate3CateNum:0,cate3CateTest:0,cate3TestNum:0,cate3TestPass:0},t={envir:document.querySelector(".naviActive").textContent,testDate:document.querySelector("#chooseDay").value},n=new XMLHttpRequest;function a(e,t,n){let a,r,o="gaugeBlock"+e,s="gauge"+e,i=0===n[1]?0:n[0]/n[1];if(null===document.getElementById(s)){a=t.append("div").attr("id",o).attr("class","gaugeBlock");t.append("i").attr("class","close icon");0===e?(a.append("div").attr("class","gaugeDesc").text("Category 1 coverage:"),a.append("div").attr("class","gaugeInfo").text(n[1]+" areas, "+n[0]+" tested.")):1===e?(a.append("div").attr("class","gaugeDesc").text("Category 2 coverage:"),a.append("div").attr("class","gaugeInfo").text(n[1]+" areas, "+n[0]+" tested.")):2===e?(a.append("div").attr("class","gaugeDesc").text("Category 3 coverage:"),a.append("div").attr("class","gaugeInfo").text(n[1]+" areas, "+n[0]+" tested.")):(a.append("div").attr("class","gaugeDesc").text("Total tests pass rate:"),1===n[1]?a.append("div").attr("class","gaugeInfo").text(n[1]+" test, "+n[0]+" passed."):a.append("div").attr("class","gaugeInfo").text(n[1]+" tests, "+n[0]+" passed.")),r=a.append("svg").attr("id",s).attr("class","gauge")}else a=d3.select("#"+o),r=d3.select("#"+s),a.select("div.gaugeInfo").text(function(){let e=this.textContent,t=e.split(/[0-9_]+/);return e=n[1]+t[1]+n[0]+t[2]});let l={minValue:0,maxValue:100,circleThickness:.05,circleFillGap:.05,circleColor:"#178BCA",waveHeight:.1,waveCount:2,waveRiseTime:2e3,waveAnimateTime:1500,waveRise:!0,waveHeightScaling:!0,waveAnimate:!0,waveColor:"#178BCA",waveOffset:.25,textVertPosition:.5,textSize:1,valueCountUp:!0,displayPercent:!0,textColor:"#045681",waveTextColor:"#A4DBf8"};l.circleColor=d3.interpolateBuGn(.6*i+.1),l.textColor=d3.interpolateBuGn(.5*i+.1),l.waveColor=d3.interpolateBuGn(.7*i+.2),l.waveTextColor=d3.interpolateBuGn(i/4),function(e,t,n){null==n&&(n={minValue:0,maxValue:100,circleThickness:.05,circleFillGap:.05,circleColor:"#178BCA",waveHeight:.1,waveCount:2,waveRiseTime:2e3,waveAnimateTime:1500,waveRise:!0,waveHeightScaling:!0,waveAnimate:!0,waveColor:"#178BCA",waveOffset:.25,textVertPosition:.5,textSize:1,valueCountUp:!0,displayPercent:!0,textColor:"#045681",waveTextColor:"#A4DBf8"});const a=e,r=a.node().id;if(a.node().childNodes.length>0)for(let e=0;e<a.node().childNodes.length;e++){const t=a.node().childNodes[e];a.node().removeChild(t)}const o=parseInt(a.style("width").substring(0,a.style("width").length-2)),s=parseInt(a.style("height").substring(0,a.style("height").length-2)),i=Math.min(o,s)/2,l=s/2-i,c=o/2-i,d=Math.max(n.minValue,Math.min(n.maxValue,t))/n.maxValue;let u=null;u=n.waveHeightScaling?d3.scaleLinear().range([0,n.waveHeight,0]).domain([0,50,100]):d3.scaleLinear().range([n.waveHeight,n.waveHeight]).domain([0,100]);const h=n.textSize*i/2,p=parseFloat(t).toFixed(2),m=n.valueCountUp?n.minValue:p,g=n.displayPercent?"%":"",f=n.circleThickness*i,y=n.circleFillGap*i,v=f+y,x=i-v,w=x*u(100*d),C=2*x/n.waveCount,N=1+n.waveCount,b=C*N;let S=function(e){return Math.round(e)};parseFloat(p)!=parseFloat(S(p))&&(S=function(e){return parseFloat(e).toFixed(1)});parseFloat(p)!=parseFloat(S(p))&&(S=function(e){return parseFloat(e).toFixed(2)});const P=[];for(let e=0;e<=40*N;e++)P.push({x:e/(40*N),y:e/40});const R=d3.scaleLinear().range([0,2*Math.PI]).domain([0,1]),L=d3.scaleLinear().range([0,i]).domain([0,i]),T=d3.scaleLinear().range([0,b]).domain([0,1]),E=d3.scaleLinear().range([0,w]).domain([0,1]),O=d3.scaleLinear().range([v+2*x+w,v-w]).domain([0,1]),I=d3.scaleLinear().range([0,b-2*x]).domain([0,1]),M=d3.scaleLinear().range([v+2*x,v+.7*h]).domain([0,1]),q=a.append("g").attr("transform","translate("+l+","+c+")"),k=d3.arc().startAngle(R(0)).endAngle(R(1)).outerRadius(L(i)).innerRadius(L(i-f));q.append("path").attr("d",k).style("fill",n.circleColor).attr("transform","translate("+i+","+i+")");const A=q.append("text").text(S(m)+g).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",h+"px").style("fill",n.textColor).attr("transform","translate("+i+","+M(n.textVertPosition)+")");let U=m;const H=d3.area().x(function(e){return T(e.x)}).y0(function(e){return E(Math.sin(2*Math.PI*n.waveOffset*-1+2*Math.PI*(1-n.waveCount)+2*e.y*Math.PI))}).y1(function(e){return 2*x+w}),D=q.append("defs").append("clipPath").attr("id","clipWave"+r),B=D.append("path").datum(P).attr("d",H).attr("T",0),z=q.append("g").attr("clip-path","url(#clipWave"+r+")");z.append("circle").attr("cx",i).attr("cy",i).attr("r",x).style("fill",n.waveColor);const G=z.append("text").text(S(m)).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",h+"px").style("fill",n.waveTextColor).attr("transform","translate("+i+","+M(n.textVertPosition)+")");let V=m;n.valueCountUp&&(A.transition().duration(n.waveRiseTime).tween("text",function(){const e=d3.interpolateNumber(U,p);return function(t){U=S(e(t)),A.text(U+g)}}),G.transition().duration(n.waveRiseTime).tween("text",function(){const e=d3.interpolateNumber(V,p);return function(t){V=S(e(t)),G.text(V+g)}}));const F=v+2*x-b;n.waveRise?D.attr("transform","translate("+F+","+O(0)+")").transition().duration(n.waveRiseTime).attr("transform","translate("+F+","+O(d)+")").on("start",function(){B.attr("transform","translate(1,0)")}):D.attr("transform","translate("+F+","+O(d)+")");n.waveAnimate&&function e(){B.attr("transform","translate("+I(B.attr("T"))+",0)");B.transition().duration(n.waveAnimateTime*(1-B.attr("T"))).ease(d3.easeLinear).attr("transform","translate("+I(1)+",0)").attr("T",1).on("end",function(){B.attr("T",0),e(n.waveAnimateTime)})}()}(r,Math.round(100*i),l)}n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let t=JSON.parse(this.responseText),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let n={testName:"QA Category",child:JSON.parse(this.responseText)},r=[];for(let e=0;e<t.length;e++){let n=t[e];void 0===r[n.testID]?(r[n.testID]={pass:0,total:0},"Pass"===n.testResult&&r[n.testID].pass++,r[n.testID].total++):("Pass"===n.testResult&&r[n.testID].pass++,r[n.testID].total++)}let o,s=[n],i=[0];for(;s.length>0;)if(i[i.length-1]<=s[s.length-1].child.length-1){let t=s[s.length-1].child[i[i.length-1]];if(t.hasOwnProperty("child"))s.push(t),i.push(0);else{if(0===i[0]?e.cate1CateNum++:1===i[0]?e.cate2CateNum++:2===i[0]&&e.cate3CateNum++,void 0!=r[t.id]){let n=r[t.id];0===i[0]?(e.cate1CateTest++,e.cate1TestNum+=n.total,e.cate1TestPass+=n.pass):1===i[0]?(e.cate2CateTest++,e.cate2TestNum+=n.total,e.cate2TestPass+=n.pass):2===i[0]&&(e.cate3CateTest++,e.cate3TestNum+=n.total,e.cate3TestPass+=n.pass)}i[i.length-1]++}}else i.pop(),s.pop(),i[i.length-1]++;(o=null===document.getElementById("modal")?d3.select("body").append("div").attr("id","modal"):d3.select("#modal")).attr("class","ui modal");let l=[];l[0]=[e.cate1CateTest,e.cate1CateNum],l[1]=[e.cate2CateTest,e.cate2CateNum],l[2]=[e.cate3CateTest,e.cate3CateNum],l[3]=[e.cate1TestPass+e.cate2TestPass+e.cate3TestPass,e.cate1TestNum+e.cate2TestNum+e.cate3TestNum];for(let e=0;e<4;e++)a(e,o,l[e]);$("#modal").modal("show")}},n.open("GET","./getTestName"),n.send()}},n.open("GET","./getLatestReports"+m(t)),n.send()}()}),document.querySelector("#exportSVG").addEventListener("click",function(){!function(){var e=document.querySelector("#contentPane svg"),t={xmlns:"http://www.w3.org/2000/xmlns/",xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},n=document.createElement("svg");n.id="tempSVG",document.querySelector("#contentPane").appendChild(n);var a=getComputedStyle(n);n.innerHTML=e.innerHTML,n.setAttribute("width",e.getAttribute("width")),n.setAttribute("height",e.getAttribute("height")),n.setAttribute("version","1.1"),n.setAttribute("xmlns",t.svg),n.setAttribute("xmlns:xlink",t.xlink),function(e,t){var n=function(e){var t=[];return t.push(e),function e(n){if(n&&n.hasChildNodes())for(var a=n.firstChild;a;)1===a.nodeType&&"SCRIPT"!=a.nodeName&&(t.push(a),e(a)),a=a.nextSibling}(e),t}(e),a=n.length;for(;a--;)r(n[a]);function r(e){var n,a,r,o,s=getComputedStyle(e),i="";for(n=0,a=s.length;n<a;n++)r=s[n],(o=s.getPropertyValue(r))!==t.getPropertyValue(r)&&(i+=r+":"+o+";");e.setAttribute("style",i)}}(n,a);var r="data:image/svg+xml;utf8,"+n.outerHTML,o=new Image;o.src=r,o.onload=function(e){var t=document.querySelector("#contentPane svg"),n=document.createElement("canvas"),a=n.getContext("2d"),r={height:getComputedStyle(t).height,width:getComputedStyle(t).width};n.height=r.height.substring(0,r.height.length-2),n.width=r.width.substring(0,r.width.length-2),n.style.height=r.height,n.style.width=r.width,a.drawImage(o,0,0,n.width,n.height);var s=n.toDataURL();document.querySelector("#tempSVG").remove();var i=document.createElement("a");i.download="ExportImage.png",i.href=s,isFirefox&&document.querySelector("#contentPane").appendChild(i),i.click(),isFirefox&&i.remove()}}()}),document.querySelector("#chooseDay").addEventListener("change",function(){d()});g(["./images/tick.svg","./images/cross.svg","./images/question.svg","./images/leftarrow.svg","./images/info.svg"]);var n=JSON.parse(sessionStorage.getItem("user")),a=document.querySelector("#loginGithub"),r=document.querySelector("#headerGitLogo"),o=document.querySelector("#loginLabel");if(n)g([n.photos[0].value]),r.src=n.photos[0].value,o.textContent=n.username,a.addEventListener("click",function(e){location.href=n.profileUrl});else{r.src="./images/github.svg",o.textContent="GitHub Login",a.addEventListener("click",function(e){location.href="./login/github"});let e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let e=this.responseText;""!=e&&(e=JSON.parse(e),r.src=e.photos[0].value,o.textContent=e.username,a.addEventListener("click",function(t){location.href=e.profileUrl}),sessionStorage.setItem("user",JSON.stringify(e)))}},e.open("GET","./getGitUser"),e.send()}var s=window.location.hash.substr(1);function l(e){document.querySelector(".naviActive").setAttribute("class","naviInactive"),e.setAttribute("class","naviActive"),document.querySelector("#envirName").textContent=e.textContent,d()}function c(e){"cardView"==e.id?(document.querySelector("#categoryView").setAttribute("class",""),document.querySelector("#buttonGroup3").style.display="none"):"categoryView"==e.id?(document.querySelector("#cardView").setAttribute("class",""),document.querySelector("#buttonGroup3").style.display="inline-block"):document.querySelector("#buttonGroup3 .buttonSelected").setAttribute("class",""),e.setAttribute("class","buttonSelected"),d()}function d(){var e={envir:document.querySelector(".naviActive").textContent,testDate:document.querySelector("#chooseDay").value},t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);if("buttonSelected"===document.querySelector("#categoryView").className){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=this.responseText;if(""!==t){var n=new XMLHttpRequest,a={milestone:"*",state:"open",labels:"question",access_token:t,per_page:100,direction:"desc",sort:"due_date"};n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.responseText);for(let a=0;a<t.length;a++){var n={testID:30,issueURL:t[a].html_url,issueName:t[a].title,labels:t[a].labels,milestone:t[a].milestone,author:t[a].user,assignees:t[a].assignees};e.push(n)}u(e)}},n.open("GET","https://api.github.com/repos/sillicon/ReportDashboard/issues"+m(a)),n.send()}else{e.push({testID:30,loginURL:"./login/github"}),u(e)}}},t.open("GET","./getGitToken"),t.send()}else u(e)}else 4==this.readyState&&(document.querySelector("#contentPane").innerHTML=this.responseText)},t.open("GET","./getLatestReports"+m(e)),t.send(),document.querySelector("#contentPane").innerHTML='<div class="ui segment"><div class="ui active inverted dimmer"><div class="ui large text loader">Loading</div></div><p></p><p></p><p></p></div>'}function u(e){if("buttonSelected"===document.querySelector("#categoryView").className)d3.json("getTestName",function(t,n){if(t)throw t;for(var a={testName:"QA Category",child:n},r=0;r<e.length;r++)for(var o=[a],s=[0],i=!1;!i&&o.length>0;)if(s[s.length-1]<=o[o.length-1].child.length-1)if(!o[o.length-1].child[s[s.length-1]].hasOwnProperty("child")||o[o.length-1].child[s[s.length-1]].child[0].hasOwnProperty("cateName")||o[o.length-1].child[s[s.length-1]].child[0].hasOwnProperty("issueURL"))if(o[o.length-1].child[s[s.length-1]].id==e[r].testID){o[o.length-1].child[s[s.length-1]].hasOwnProperty("child")||(o[o.length-1].child[s[s.length-1]].child=[]);let t={};e[r].hasOwnProperty("loginURL")?t.loginURL=e[r].loginURL:e[r].hasOwnProperty("issueURL")?(t.issueURL=e[r].issueURL,t.issueName=e[r].issueName,t.labels=e[r].labels,t.milestone=e[r].milestone,t.author=e[r].author,t.assignees=e[r].assignees):(t.testName=e[r].fileName,t.testResult=e[r].testResult,t.cateName=e[r].testName,t.uniqueID=e[r]._id,t.comments=e[r].comments,e[r].hasOwnProperty("reportURL")&&(t.reportURL=e[r].reportURL),r!=e.length-1&&e[r].testID==e[r+1].testID||(o[o.length-1].child[s[s.length-1]].testResult=e[r].testResult)),o[o.length-1].child[s[s.length-1]].child.push(t),r<e.length-1?i=!0:s[s.length-1]++}else s[s.length-1]++;else o.push(o[o.length-1].child[s[s.length-1]]),s.push(0);else{for(var l=0;l<o[o.length-1].child.length;l++)!o[o.length-1].child[l].hasOwnProperty("testResult")||o[o.length-1].hasOwnProperty("testResult")&&"Fail"!=o[o.length-1].child[l].testResult||(o[o.length-1].testResult=o[o.length-1].child[l].testResult);s.pop(),o.pop(),s[s.length-1]++}document.querySelector("#contentPane").innerHTML="";var c=document.querySelector("#buttonGroup3 .buttonSelected");"sunburstView"==c.id?function(e){document.querySelector("#exprotContainer").style.display="block";var t=getComputedStyle(document.querySelector("#contentPane")).width,n=Math.min(parseInt(t.substr(0,t.length-2))-50,window.innerHeight-250),a=n+100,r=n/2-40,o=(d3.format(",d"),d3.scaleLinear().range([0,2*Math.PI])),s=d3.scaleSqrt().range([0,r]),i=d3.partition(),l=d3.arc().startAngle(function(e){return Math.max(0,Math.min(2*Math.PI,o(e.x0)))}).endAngle(function(e){return Math.max(0,Math.min(2*Math.PI,o(e.x1)))}).innerRadius(function(e){return Math.max(0,s(e.y0))}).outerRadius(function(e){return Math.max(0,s(e.y1))}),c=d3.select("#contentPane").append("svg").attr("width",n).attr("height",a).append("g").attr("transform","translate("+n/2+","+a/2+")");(e=d3.hierarchy(e,function(e){return e.child})).sum(function(e){return null!=e.child?0:1}),c.selectAll("path").data(i(e).descendants()).enter().append("path").attr("d",l).attr("class",function(e){return e.data.hasOwnProperty("testResult")?"Pass"==e.data.testResult?"sunburstPath testPass":"sunburstPath testFail":"sunburstPath norun"}).on("click",function(e){!e.children&&e.data.hasOwnProperty("cateName")?e.data.hasOwnProperty("reportURL")?window.open(e.data.reportURL):window.open(".\\report\\"+e.data.testName):e.data.hasOwnProperty("loginURL")?window.open(e.data.loginURL):e.data.hasOwnProperty("issueURL")?window.open(e.data.issueURL):c.transition().duration(750).tween("scale",function(){var t=d3.interpolate(o.domain(),[e.x0,e.x1]),n=d3.interpolate(s.domain(),[e.y0,1]),a=d3.interpolate(s.range(),[e.y0?20:0,r]);return function(e){o.domain(t(e)),s.domain(n(e)).range(a(e))}}).selectAll("path").attrTween("d",function(e){return function(){return l(e)}})}).on("mouseover",function(e){var t=function e(t){var n="";if(t.data.hasOwnProperty("loginURL"))return n="Click here to authorize GitHub access";n=t.data.hasOwnProperty("issueURL")?t.data.issueName:t.data.testName;return null==t.parent?n:e(t.parent)+">"+n}(e),a=2*(n-50)/3;!function(e,t){var a,r=e.text().split(/>/g).reverse(),o=[],s=(e.attr("y"),parseFloat(e.attr("font-size")));if(isChrome)var i=e.text(null).append("tspan").attr("x",0).attr("dy",s+"rem").attr("text-anchor","middle");else var i=e.text(null).append("tspan").attr("x",0).attr("dy",0).attr("text-anchor","middle");for(;a=r.pop();)if(o.push(a),i.text(o.join(" > ")),i.node().getComputedTextLength()>t){o.pop(),i.text(o.join(" > ")+" >"),o=[a];i.node().getComputedTextLength();i=isChrome?e.append("tspan").attr("text-anchor","middle").attr("x",0).attr("dy",s+"rem").text(a):e.append("tspan").attr("text-anchor","middle").attr("x",0).attr("dy",22).text(a)}e.attr("transform","translate("+n/2+", 20)")}(d3.select("#cateDescription").text(t),a)}).append("title").text(function(e){return e.data.testName});d3.select("#contentPane svg").append("text").attr("font-size","1.3rem").attr("id","cateDescription").text("QA Category").attr("transform","translate("+n/2+", 20)").attr("text-anchor","middle");d3.select(self.frameElement).style("height",a+"px")}(a):"circlePackView"==c.id?function(e){document.querySelector("#exprotContainer").style.display="block";var t,n=getComputedStyle(document.querySelector("#contentPane")).width,a=Math.min(parseInt(n.substr(0,n.length-2))-50,window.innerHeight-200),r=a,o=d3.select("#contentPane").append("svg").attr("height",r).attr("width",a).style("overflow","hidden"),s=20,i=+o.attr("width"),l=o.append("g").attr("transform","translate("+i/2+","+i/2+")"),c=d3.scaleLinear().domain([0,5]).range(["hsl(193, 50%, 80%)","hsl(215,80%,40%)"]).interpolate(d3.interpolateHcl),d=d3.pack().size([i-s,i-s]).padding(2),u=e=d3.hierarchy(e,function(e){return e.child}).sum(function(e){return null!=e.child?0:1}).sort(function(e,t){return t.value-e.value}),h=d(e).descendants(),p=l.selectAll("circle").data(h).enter().append("circle").attr("class",function(e){return e.parent?e.children?"circlePacknode":"circlePacknode circlePacknode--leaf":"circlePacknode circlePacknode--root"}).style("fill",function(e){return e.children?c(e.depth):e.data.hasOwnProperty("testResult")?"Pass"==e.data.testResult?"#00a300":"#ff3030":"#c7c7c7"}).on("click",function(e){u!==e?(g(e),d3.event.stopPropagation()):!e.children&&e.data.hasOwnProperty("cateName")?e.data.hasOwnProperty("reportURL")?window.open(e.data.reportURL):window.open(".\\report\\"+e.data.testName):e.data.hasOwnProperty("loginURL")?window.open(e.data.loginURL):e.data.hasOwnProperty("issueURL")&&window.open(e.data.issueURL)}),m=(l.selectAll("text").data(h).enter().append("text").attr("class","circlePacklabel").style("fill-opacity",function(t){return t.parent===e?1:0}).style("display",function(t){return t.parent===e?"inline":"none"}).text(function(e){return e.data.hasOwnProperty("loginURL")?"Click here to authorize GitHub access":e.data.hasOwnProperty("issueURL")?e.data.issueName:e.data.hasOwnProperty("reportURL")?e.data.reportURL:e.data.testName}),l.selectAll("circle,text"));function g(e){u=e;var n=d3.transition().duration(d3.event.altKey?7500:750).tween("zoom",function(e){var n=d3.interpolateZoom(t,[u.x,u.y,2*u.r+s]);return function(e){f(n(e))}});n.selectAll("text").filter(function(e){return e.parent===u||"inline"===this.style.display}).style("fill-opacity",function(e){return e.parent===u?1:0}).on("start",function(e){e.parent===u&&(this.style.display="inline")}).on("end",function(e){e.parent!==u&&(this.style.display="none")})}function f(e){var n=i/e[2];t=e,m.attr("transform",function(t){return"translate("+(t.x-e[0])*n+","+(t.y-e[1])*n+")"}),p.attr("r",function(e){return e.r*n})}o.style("background",c(0)).on("click",function(){g(e)}),f([e.x,e.y,2*e.r+s])}(a):"treemapView"==c.id?function(e){document.querySelector("#exprotContainer").style.display="none";for(let t=0;t<e.child.length;t++){let n=e.child[t];if(n.testName.indexOf("Category 4")>-1){e.child.splice(t,1);break}}var t=getComputedStyle(document.querySelector("#contentPane")).width,n=parseInt(t.substr(0,t.length-2))-50,a=n+100,r=d3.select("#contentPane").append("svg").attr("width",n).attr("height",a),o=d3.scaleLinear().domain([0,7]).range(["hsl(193, 50%, 80%)","hsl(215,80%,40%)"]).interpolate(d3.interpolateHcl),s=d3.treemap().size([n,a]).paddingOuter(5).paddingTop(32).paddingInner(5).tile(d3.treemapBinary);(e=d3.hierarchy(e,function(e){return e.child})).sum(function(e){return null!=e.child?e.hasOwnProperty("id")?1:0:1}),s(e);var i=r.selectAll(".treemapNode").data(e.descendants()).enter().append("g").attr("transform",function(e){return"translate("+e.x0+","+e.y0+")"}).attr("class","treemapNode").each(function(e){e.node=this}).on("mouseover",c(!0)).on("mouseout",c(!1)).on("click",function(e){!e.children&&e.data.hasOwnProperty("cateName")&&(e.data.hasOwnProperty("reportURL")?window.open(e.data.reportURL):window.open(".\\report\\"+e.data.testName))});i.append("rect").attr("id",function(e){return e.data.hasOwnProperty("cateName")?"rect-"+encodeURI(e.data.testName.substring(0,e.data.testName.lastIndexOf("."))):"rect-"+encodeURI(e.data.testName)}).attr("width",function(e){return e.x1-e.x0}).attr("height",function(e){return e.y1-e.y0}).style("fill",function(e){return e.data.hasOwnProperty("cateName")?"Pass"==e.data.testResult?"#79de79":"#ff7777":o(e.depth)}),i.append("clipPath").attr("id",function(e){return e.data.hasOwnProperty("cateName")?"clip-"+encodeURI(e.data.testName.substring(0,e.data.testName.lastIndexOf("."))):"clip-"+encodeURI(e.data.testName)}).append("use").attr("xlink:href",function(e){return e.data.hasOwnProperty("cateName")?"#rect-"+encodeURI(e.data.testName.substring(0,e.data.testName.lastIndexOf("."))):"#rect-"+encodeURI(e.data.testName)});var l=i.append("text").attr("class","treemapNode").attr("clip-path",function(e){return e.data.hasOwnProperty("cateName")?"url(#clip-"+encodeURI(e.data.testName.substring(0,e.data.testName.lastIndexOf(".")))+")":"url(#clip-"+encodeURI(e.data.testName)+")"});function c(e){return function(t){d3.selectAll(t.ancestors().map(function(e){return e.node})).classed("treemapNode--hover",e).select("rect").attr("width",function(t){return t.x1-t.x0-e}).attr("height",function(t){return t.y1-t.y0-e})}}l.filter(function(e){return e.children}).selectAll("tspan").data(function(e){return[e.data.testName]}).enter().append("tspan").attr("x",function(e,t){return t?null:5}).attr("y",20).text(function(e){return e}),l.filter(function(e){return!e.children}).selectAll("tspan").data(function(e){if(e.data.hasOwnProperty("cateName")){var t=e.data.testName.substring(0,e.data.testName.lastIndexOf(".")).match(/[a-zA-Z]+|[0-9_]+/g),n=t[1].split(/_/g);return t[1]="",t[2]=n[0]+"/"+n[1]+"/"+n[2],t[3]=n[3]+":"+n[4]+":"+n[5],t}return e.data.testName.split(/ /g)}).enter().append("tspan").attr("x",5).attr("y",function(e,t){return 20+20*t}).text(function(e){return e}),l.filter(function(e){return e.data.hasOwnProperty("cateName")}).attr("class","treemapNode reportName").attr("cursor","pointer"),i.append("title").text(function(e){return e.data.hasOwnProperty("reportURL")?e.data.reportURL:e.data.testName})}(a):"treeView"==c.id?function(e){isIE||isEdge||(document.querySelector("#exprotContainer").style.display="block");var t={top:0,right:80,bottom:20,left:120},n=getComputedStyle(document.querySelector("#contentPane")).width,a=parseInt(n.substr(0,n.length-2))-200,r=800-t.top-t.bottom,o=0,s=750,i=d3.tree().size([r,a]),l=d3.select("#contentPane").append("svg").attr("width",a+t.right+t.left).attr("height",r+t.top+t.bottom).append("g").attr("transform","translate("+t.left+","+t.top+")");function c(t){var n=i(e),r=n.descendants(),c=n.descendants().slice(1),h=a/5;r.forEach(function(e){e.y=e.depth*h});var p=l.selectAll("g.treeNode").data(r,function(e){return e.id||(e.id=++o)}),m=p.enter().append("g").attr("class","treeNode").attr("transform",function(e){return"translate("+t.y0+","+t.x0+")"}).on("click",u);m.append("circle").attr("class","treeNode").attr("r",1e-6).style("fill",function(e){return void 0==e.data.testResult?e.children||e._children?"lightsteelblue":"#a1a1a1":"Pass"==e.data.testResult?"#00a300":"Fail"==e.data.testResult?"#ff3030":void 0}),m.append("text").attr("dy",".35em").attr("x",function(e){return e.children||e._children?-13:13}).attr("text-anchor",function(e){return e.children||e._children?"end":"start"}).attr("cursor","pointer").text(function(e){return e.data.hasOwnProperty("loginURL")?"Click here to authorize GitHub access":e.data.hasOwnProperty("issueURL")?e.data.issueName:e.data.testName}).on("click",function(e){e.data.hasOwnProperty("cateName")?e.data.hasOwnProperty("reportURL")?window.open(e.data.reportURL):window.open(".\\report\\"+e.data.testName):e.data.hasOwnProperty("loginURL")?window.open(".\\login\\github"):e.data.hasOwnProperty("issueURL")&&window.open(e.data.issueURL)});var g=m.merge(p);g.transition().duration(s).attr("transform",function(e){return"translate("+e.y+","+e.x+")"}),g.select("circle.treeNode").attr("r",10).attr("cursor","pointer");var f=p.exit().transition().duration(s).attr("transform",function(e){return"translate("+t.y+","+t.x+")"}).remove();f.select("circle").attr("r",1e-6),f.select("text").style("fill-opacity",1e-6);var y=l.selectAll("path.treeLink").data(c,function(e){return e.id}),v=y.enter().insert("path","g").attr("class","treeLink").attr("d",function(e){var n={x:t.x0,y:t.y0};return d(n,n)}),x=v.merge(y);x.transition().duration(s).attr("d",function(e){return d(e,e.parent)});y.exit().transition().duration(s).attr("d",function(e){var n={x:t.x,y:t.y};return d(n,n)}).remove();r.forEach(function(e){e.x0=e.x,e.y0=e.y})}function d(e,t){return path="M "+e.y+" "+e.x+" C "+(e.y+t.y)/2+" "+e.x+" , "+(e.y+t.y)/2+" "+t.x+" , "+t.y+" "+t.x,path}function u(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null),c(e)}(e=d3.hierarchy(e,function(e){return e.child})).x0=r/2,e.y0=0,e.children.forEach(function e(t){t.children&&(t._children=t.children,t._children.forEach(e),t.children=null)}),c(e)}(a):"ordinaryView"==c.id&&p(a)});else{var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.responseText),n=Object.keys(t).map(function(e){return t[e]});if(document.querySelector("#contentPane").innerHTML="",0!==e.length){n.splice(n.indexOf(e[0].testName),1);var a="Pass"==e[0].testResult?1:0,r=[e[0]];if(1===e.length)h(a,r,e[0].testName);else for(var o=1;o<e.length;o++)e[o].testName!=e[o-1].testName?(n.splice(n.indexOf(e[o-1].testName),1),h(a,r,e[o-1].testName),a=0,r=[e[o]]):r.push(e[o]),a="Pass"==e[o].testResult?a+1:a,o==e.length-1&&h(a,r,e[o].testName)}n.sort(function(e,t){return e>t?1:e<t?-1:0});for(o=0;o<n.length;o++)n[o].indexOf("Area 30")<0&&n[o].indexOf("Area 31")<0&&h(0,[],n[o])}else 4==this.readyState&&(document.querySelector("#contentPane").innerHTML=this.responseText)},t.open("GET","./getIDRef"),t.send()}}function h(e,t,n){var a=t.length,r=50,o=10,s=200-o-10,i=200-r-50,l=d3.select("#contentPane").append("div").attr("class","areaCard");l.append("div").attr("class","fieldTitle").text(n),l.append("div").style("font-size","1.1rem").text("Total test run for today: "+a);var c=l.append("svg").attr("style","width: 200px; height: 200px;");if(0!=a){var d=e/a,u=c.append("text").text(null);u.attr("x",100).attr("y",110).attr("font-size","40px").attr("fill","#b6b6b6").attr("font-weight","bold").text(function(){return e<a?a-e:e});var h=u.node().getComputedTextLength();u.attr("x",100-h/2);var p=c.append("text").text(null);p.attr("x",100).attr("y",170).attr("font-size","1.5rem").attr("fill","#b6b6b6").text(function(){return e<a?"Fail":"Pass"});var m=p.node().getComputedTextLength();p.attr("x",100-m/2);var g=c.data(function(){for(var e=[],n=0;n<t.length;n++)"Pass"==t[n].testResult&&(t[n].hasOwnProperty("reportURL")?e.push(t[n].reportURL):e.push(t[n].fileName));return[e]}).append("path").attr("class","successArc").attr("transform","translate("+(s/2+o)+","+(i/2+r)+")"),f=c.data(function(){for(var e=[],n=0;n<t.length;n++)"Fail"==t[n].testResult&&(t[n].hasOwnProperty("reportURL")?e.push(t[n].reportURL):e.push(t[n].fileName));return[e]}).append("path").attr("class","failArc").attr("transform","translate("+(s/2+o)+","+(i/2+r)+")"),y=d3.arc().innerRadius(s/2-30).outerRadius(s/2).startAngle(3*-Math.PI/4),v=d3.arc().innerRadius(s/2-30).outerRadius(s/2).startAngle(3*-Math.PI/4+d*Math.PI*3/2),x=0,w=0,C=setInterval(function(){x<100*d?(y.endAngle(3*-Math.PI/4+x/100*Math.PI*3/2),g.attr("d",y),x++):x>=100*d&&0==w?(y.endAngle(3*-Math.PI/4+d*Math.PI*3/2),g.attr("d",y),v.endAngle(3*-Math.PI/4+(d+w/100)*Math.PI*3/2),f.attr("d",v),w++):x+w<100?(v.endAngle(3*-Math.PI/4+(d+w/100)*Math.PI*3/2),f.attr("d",v),w++):x+w==100&&(v.endAngle(3*Math.PI/4),f.attr("d",v),clearInterval(C))},10);R(g,y),R(f,v)}else{var N=c.append("text").text(null);N.attr("x",100).attr("y",170).attr("font-size","1.5rem").attr("fill","#b6b6b6").text("Not Run");h=N.node().getComputedTextLength();N.attr("x",100-h/2);var b=c.append("path").attr("class","noneArc").attr("transform","translate("+(s/2+o)+","+(i/2+r)+")"),S=d3.arc().innerRadius(s/2-30).outerRadius(s/2).startAngle(3*-Math.PI/4).endAngle(3*Math.PI/4),P=0;C=setInterval(function(){P<100?(S.endAngle(3*-Math.PI/4+P/100*Math.PI*3/2),b.attr("d",S),P++):(S.endAngle(3*Math.PI/4),b.attr("d",S),clearInterval(C))},10)}function R(e,t){e.on("mouseover",function(){t.outerRadius(s/2+5),e.attr("d",t)}).on("mouseout",function(){t.outerRadius(s/2),e.attr("d",t)}).on("click",function(e){var t=d3.select("#reportList"),n=c._groups[0][0],a=d3.mouse(n);t.html(function(){for(var t="",n=0;n<e.length;n++)e[n].indexOf("http")>-1?t+="<span><a href='"+e[n]+"' target='_blank'>Click here for report</a></span><br>":t+="<span><a href='.\\report\\"+e[n]+"' target='_blank'>"+e[n]+"</a></span><br>";return t}),t.style("display","block"),t.style("left",function(){for(var e,t=n.getBoundingClientRect().left,r=(n.getBoundingClientRect().width,this.getBoundingClientRect().width),o=document.styleSheets,s=0;s<o.length;s++)if(o[s].href.indexOf("Home")>-1){isFirefox?mainSheet=o[s].cssRules:mainSheet=o[s].rules,s=o.length;for(var i=0;i<mainSheet.length;i++)"div.testListTip::after"===mainSheet[i].selectorText&&(tipAfterRule=mainSheet[i],i=mainSheet.length)}return isIE?tipAfterRule.style.margin="-5px 0px 0px -16px":tipAfterRule.style.margin="-5px 0px 0px -"+(r/2+10)+"px",isSafari||isEdge?e=document.getElementsByTagName("body")[0].scrollLeft:(isChrome||isFirefox||isIE)&&(e=document.getElementsByTagName("html")[0].scrollLeft),t+a[0]+e+15+"px"}),t.style("top",function(){var e,t=n.getBoundingClientRect().top,r=(n.getBoundingClientRect().height,this.getBoundingClientRect().height);return isSafari||isEdge?e=document.getElementsByTagName("body")[0].scrollTop:(isChrome||isFirefox||isIE)&&(e=document.getElementsByTagName("html")[0].scrollTop),t+a[1]+e-r/2+"px"})})}l.append("a").attr("href","https://github.com/sillicon").attr("target","_blank").style("font-size","1.1rem").text("Test case description")}function p(e){document.querySelector("#exprotContainer").style.display="none";for(var t=[e],n=[r(e,document.querySelector("#contentPane"))],a=[0];t.length>0;)a[a.length-1]<=t[t.length-1].child.length-1?t[t.length-1].child[a[a.length-1]].hasOwnProperty("child")?(n.push(r(t[t.length-1].child[a[a.length-1]],n[n.length-1])),t.push(t[t.length-1].child[a[a.length-1]]),a.push(0)):(r(t[t.length-1].child[a[a.length-1]],n[n.length-1]),a[a.length-1]++):(n.pop(),a.pop(),t.pop(),a[a.length-1]++);function r(e,t){let n,a=document.createElement("div"),r=document.createElement("button"),s=document.createElement("div"),i=document.createElement("div"),l='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 8 16 16" class="plus"><path d="M15 17H9v6H7v-6H1v-2h6V9h2v6h6v2z"></path></svg>',c='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 8 16 16" class="minus"><path d="M15 17H1v-2h14v2z"></path></svg>';if(t.appendChild(a),a.className="ordinaryCard",t!=document.querySelector("#contentPane")&&t.parentNode!=document.querySelector("#contentPane > div")&&(a.style.display="none"),a.style.textAlign="left",a.appendChild(r),a.appendChild(s),r.style.cssFloat="left","contentPane"===t.id?r.innerHTML=c:r.innerHTML=l,s.className="nameCard",i.className="cardHolder",e.hasOwnProperty("child")?(a.appendChild(i),r.className="haschild",r.onclick=function(t){let n=this.parentNode;this.firstChild.className.baseVal.indexOf("plus")>-1?this.innerHTML=c:this.innerHTML=l,$($(n.children[2]).children()).transition({animation:"slide down",duration:Math.min(1e3/e.child.length,300),interval:Math.min(80,Math.max(200/e.child.length,10))})}):e.hasOwnProperty("cateName")?r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" class="report"><path d="M22 24h4v2h-4v-2zm0-12h4v2h-4v-2zm0 4h4v2h-4v-2zM8 6h10v2H8V6zm14 14h4v2h-4v-2zM8 12h10v2H8v-2zm0 4h12v2H8v-2zM22.801 0H4v32h26V7.199L22.801 0zM28 30H6V2h14v8h8v20zm0-22h-6V2h.621L28 7.379V8zM8 20h12v2H8v-2zm0 4h10v2H8v-2z"/></svg>':r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 8 16 16" class="dot"><circle cx="8" cy="16" r="4"></circle></svg>',e.hasOwnProperty("loginURL")||e.hasOwnProperty("issueURL"))n=document.createElement("a"),s.appendChild(n),r.style.border="5px solid #e3e3e3",e.hasOwnProperty("loginURL")?(s.className+=" login",n.textContent="Click here to authorize GitHub access",n.href=e.loginURL):e.hasOwnProperty("issueURL")&&(s.className+=" issueTitle",n.textContent=e.issueName,n.href=e.issueURL,n.target="_blank",n.className="issueName");else{if(n=document.createElement("div"),s.appendChild(n),e.hasOwnProperty("testResult")?"Pass"===e.testResult?(s.style.backgroundColor="#deffde",r.style.border="5px solid #66dc66"):(s.style.backgroundColor="#ffe7e7",r.style.border="5px solid #ffb2b2"):r.style.border="5px solid #e3e3e3",n.textContent=e.testName,n.className="fieldTitle",["Test Category 4","Test Area 30","Test Area 31"].indexOf(e.testName)>-1){let e=document.createElement("i");e.className="github icon",e.style.color="black",e.style.paddingLeft="20px",n.appendChild(e)}if(e.hasOwnProperty("id")&&["Test Area 30","Test Area 31"].indexOf(e.testName)<0){let e=document.createElement("a");e.href="https://github.com/sillicon",e.target="_blank",e.style.textDecoration="none";let t=document.createElement("i");t.className="info circle icon",t.style.fontSize="1.4rem",t.style.cssFloat="right",t.style.color="#42aaf5",t.title="Click for more info",e.appendChild(t),n.appendChild(e)}if(e.hasOwnProperty("cateName")){n.style.cursor="pointer",n.onclick=function(t){"label"!=t.target.tagName.toLowerCase()&&"i"!=t.target.tagName.toLowerCase()&&(e.hasOwnProperty("reportURL")?window.open(e.reportURL):window.open(".\\report\\"+e.testName))};let t=document.createElement("div"),a=e.testName.substring(0,e.testName.lastIndexOf(".")).match(/[a-zA-Z]+|[0-9_]+/g)[1],r=a.split(/_/g);a="Test Date: "+r[0]+"/"+r[1]+"/"+r[2]+"<br>Upload Time: "+r[3]+":"+r[4]+":"+r[5],t.innerHTML=a,t.style.margin="auto auto 10px 30px";let i=JSON.parse(sessionStorage.getItem("user"));if(i&&["sillicon"].indexOf(i.username)>-1){let t=document.createElement("i"),a=document.createElement("i");n.appendChild(t),n.appendChild(a),t.className="write icon",t.style.color="black",t.style.marginLeft="10px",t.title="Change result",a.className="trash outline icon",a.style.color="black",a.title="Delete report",t.onclick=function(t){let n,a,r,o,s,i,l;null===document.getElementById("editModal")?(n=document.createElement("div"),document.querySelector("body").appendChild(n),n.id="editModal",n.className="ui modal",a=document.createElement("div"),r=document.createElement("div"),o=document.createElement("actions"),s=document.createElement("div"),i=document.createElement("div"),l=document.createElement("i"),a.className="header",r.className="content",o.className="actions",s.className="ok button",i.className="cancel button",l.className="close black icon",s.textContent="OK",i.textContent="Cancel",a.textContent="Change test result",n.appendChild(a),n.appendChild(r),o.appendChild(s),o.appendChild(i),n.appendChild(o),n.appendChild(l)):(a=(n=document.querySelector("#editModal")).querySelector(".header"),r=n.querySelector(".content"),o=n.querySelector(".actions"),s=n.querySelector(".ok.button"),i=n.querySelector(".cancel.button")),r.textContent="Do you want to alter the test result?","Pass"===e.testResult?r.textContent+=" (Pass to Fail)":r.textContent+=" (Fail to Pass)",$("#editModal").modal({inverted:!0,onApprove:function(){let t={_id:e.uniqueID},n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status)d();else if(4==this.readyState&&500==this.status){let e,t,n;null===document.getElementById("warnModal")?(e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("i"),document.querySelector("body").appendChild(e),e.id="warnModal",e.className="ui modal",n=document.createElement("i"),t.className="content",n.className="close black icon",e.appendChild(t),e.appendChild(n)):(t=(e=document.querySelector("#warnModal")).querySelector(".content"),n=e.querySelector(".close.icon")),t.textContent=this.responseText,$("#warnModal").modal({inverted:!0,onHidden:d()}).modal("setting","transition","scale").modal("show")}},n.open("GET","./alterResult"+m(t)),n.send()}}).modal("setting","transition","scale").modal("show")},a.onclick=function(t){let n,a,r,o,s,i,l;null===document.getElementById("deleteModal")?(n=document.createElement("div"),document.querySelector("body").appendChild(n),n.id="deleteModal",n.className="ui modal",a=document.createElement("div"),r=document.createElement("div"),o=document.createElement("actions"),s=document.createElement("div"),i=document.createElement("div"),l=document.createElement("i"),a.className="header",r.className="content",o.className="actions",s.className="delete ok button",i.className="cancel button",l.className="close black icon",s.textContent="Delete",i.textContent="Cancel",a.textContent="Delete test result",r.textContent="Do you want to delete this result?",n.appendChild(a),n.appendChild(r),o.appendChild(s),o.appendChild(i),n.appendChild(o),n.appendChild(l)):(a=(n=document.querySelector("#deleteModal")).querySelector(".header"),r=n.querySelector(".content"),o=n.querySelector(".actions"),s=n.querySelector(".delete.ok.button"),i=n.querySelector(".cancel.button")),$("#deleteModal").modal({inverted:!0,onApprove:function(){let t={_id:e.uniqueID},n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status)d();else if(4==this.readyState&&500==this.status){let e,t,n;null===document.getElementById("warnModal")?(e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("i"),document.querySelector("body").appendChild(e),e.id="warnModal",e.className="ui modal",n=document.createElement("i"),t.className="content",n.className="close black icon",e.appendChild(t),e.appendChild(n)):(t=(e=document.querySelector("#warnModal")).querySelector(".content"),n=e.querySelector(".close.icon")),t.textContent=this.responseText,$("#warnModal").modal({inverted:!0,onHidden:d()}).modal("setting","transition","scale").modal("show")}},n.open("GET","./deleteResult"+m(t)),n.send()}}).modal("setting","transition","scale").modal("show")}}let l=document.createElement("i"),c=document.createElement("label");c.className="coNum",l.style.cssFloat="right",l.style.fontSize="1.3rem",l.style.color="#005e95",l.className="comment outline icon",l.title="Toggle comment",l.onclick=function(e){e.stopPropagation(),this.className.indexOf("outline")>-1?(this.className="comment icon",this.style.color="#42aaf5"):(this.className="comment outline icon",this.style.color="#005e95");let t=this.parentNode;$(t.parentNode.childNodes[2]).transition({animation:"slide down",duration:400,interval:30})},n.appendChild(l),n.appendChild(c),s.appendChild(t);let u=document.createElement("div");u.className="commentsHolder";let h=document.createElement("div");if(h.textContent="Comments",h.style.fontWeight="bold",h.style.borderBottom="1px solid #000000",u.appendChild(h),e.comments&&e.comments.length>0){c.textContent=e.comments.length;for(let t=0;t<e.comments.length;t++)o(e.comments[t],u,"append")}else{c.textContent="0";let e=document.createElement("div");e.className="commentCard nocomment",e.textContent="No comment",u.appendChild(e)}let p=document.createElement("div");if(p.className="cardButton",i){p.textContent="Comment",p.className+=" buttonDisabled";let t=document.createElement("img");t.src=i.photos[0].value,t.className="avatar",t.alt="userAvatar",u.appendChild(t);let n=document.createElement("textarea");n.placeholder="Leave a comment",n.maxLength=255,n.oninput=function(e){""!=e.target.value?p.className="cardButton":p.className="cardButton buttonDisabled"},u.appendChild(n),p.onclick=function(t){t.target.className="cardButton buttonDisabled";let n=JSON.parse(sessionStorage.getItem("user")).displayName;null==n&&(n=JSON.parse(sessionStorage.getItem("user")).username);let a={_id:e.uniqueID,commenter:n,commentText:t.target.previousElementSibling.value},r=new XMLHttpRequest;r.open("POST","./publishComment"),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(a)),r.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let e=t.target.previousElementSibling.previousElementSibling.previousElementSibling;"commentCard nocomment"===e.className&&$(e).remove(),o({commenter:a.commenter,commentTime:(new Date).toLocaleString(),comment:a.commentText},t.target.previousElementSibling.previousElementSibling,"insert"),t.target.previousElementSibling.value="",t.target.className="cardButton buttonDisabled"}}}}else p.textContent="Log in to comment",p.onclick=function(){location.href="./login/github"};u.appendChild(p),$(u).transition("hide"),s.appendChild(u)}}if(e.hasOwnProperty("issueURL")){s.appendChild(document.createElement("br"));for(let t=0;t<e.labels.length;t++){let n=document.createElement("div");n.className="label",n.textContent=e.labels[t].name,n.style.backgroundColor="#"+e.labels[t].color;let a=parseInt(e.labels[t].color,16),r=.2126*(a>>16&255)+.7152*(a>>8&255)+.0722*(a>>0&255);n.style.color=r>150?"black":"white",s.appendChild(n)}let t=document.createElement("div");if(t.className="info",t.textContent="assigned to:",0===e.assignees.length)t.textContent+=" none";else for(let n=0;n<e.assignees.length;n++)t.textContent+=" "+e.assignees[n].login;t.textContent+=" created by: "+e.author.login+" milestone: "+e.milestone.title,s.appendChild(t)}return i}function o(e,t,n){let a=document.createElement("div");a.className="commentCard";let r=document.createElement("div"),o=document.createElement("label"),i=document.createElement("label"),l=document.createElement("div");null!=e.commenter?(r.textContent=e.commenter.substring(0,1).toUpperCase(),r.style.backgroundColor="hsl("+Math.abs(parseInt(s(e.commenter.substr(-7)),16)/268435455)+", 50%, 70%)",o.textContent=e.commenter):(r.textContent="A",o.textContent="Anonymous",r.style.backgroundColor="hsl("+Math.abs(parseInt(s("Anonymous".substr(-7)),16)/268435455)+", 50%, 70%)"),r.className="coAvatar",o.className="coName",i.textContent=new Date(e.commentTime).toLocaleString(),i.className="coTimelabel",l.textContent=e.comment,l.className="coText",a.appendChild(r),a.appendChild(o),a.appendChild(i),a.appendChild(l),"append"===n?t.appendChild(a):"insert"===n&&t.parentNode.insertBefore(a,t)}function s(e){var t=0;if(0==e.length)return t;for(i=0;i<e.length;i++)char=e.charCodeAt(i),t=(t<<5)-t+char,t&=t;return t}}function m(e){return"?"+Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function g(e){g.list||(g.list=[]);for(var t=g.list,n=0;n<e.length;n++){var a=new Image;a.onload=function(){var e=t.indexOf(this);-1!==e&&t.splice(e,1)},t.push(a),a.src=e[n]}}"envir2"==s?l(document.querySelector("#envir2")):"envir3"==s?l(document.querySelector("#envir3")):d()};